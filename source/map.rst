.. sectionauthor:: Дмитрий Барышников <dmitry.baryshnikov@nextgis.ru>

.. _ngqgis_map:

********************************
Создание карты
********************************

Проекции
====================

В кугисе есть возможность работы с проекциями. У каждого слоя данных есть своя система координат (в которой храняться данные), как правило она записана в самом файле. Почти всегда в кугисе используется функция "преобразования координат на лету": слои хранятся в разных системах координат, а на экран они выводятся в одной. 

Систем координат очень много, однако для работы одновременно используется всего 2-4 штуки, их можно запомнить. 

* WGS 84 (EPSG:4326) - в ней обычно хранятся векторные данные. Единица измерения - градусы. Новые векторные файлы сохраняйте в ней. Если вывести данные из неё без перепроецирования, то картинка будет сплющенной.
* Pseudo Mercator (EPSG:3857) - используется для отображения. Включайте "перепроецирование на лету" в 3857, и карта будет отображаться более правильно.
* WGS 84 / UTM Zone ... (EPSG:12345.. и соседние) - используется для измерения расстояний. Данные хранятся в метрах. Некоторые инструменты требуют её для корректной работы. Так же в ней могут храниться космоснимки. Земной шар разделён на 30 зон, для каждой определена своя проекция - свой код EPSG. Определите зону в которой вы работаете по разграфкам на гис-лабе.
* Pulkovo 1942 / Gauss-Kruger zone ... (EPSG:12345.. и соседние) - устроена так же как UTM, в ней хранятся привязанные листы советских топокарт (изданных в последние годы). Так же разделена на зоны, но с другими номерами. 

.. fixme:
   дописать коды EPSG, возможно сверстать в таблицу

Интерфейс окна выбора системы координат
---------------------------------------------------------------------

QGIS поддерживает перепроецирование растровых и векторных слоёв "на лету", но по умолчанию
эта возможность отключена. Для её активации необходимо установить флажок "Включить 
преобразование координат "на лету" на вкладке "Система координат" диалогового окна 
"Свойства проекта". 
Существует три способа доступа к указанной вкладке:

1. Выберите пункт "Свойства проекта" в меню Редактирование (Gnome, OS X) или Установки
(KDE, Windows).

2. Нажмите кнопку "Преобразование координат", расположенную в правом нижнем углу строки
состояния.

.. figure:: /_static/MapOTF.png
   :align: center
   :width: 35em



.. tip::
   Так же можно его включить по умолчанию: :menuselection:`Параметры --> Система координат --> Система координат для новых проектов` 

.. fixme::
   Переформулировать, очень длинные названия, не понимаю.

.. figure:: /_static/MapProjections.png
   :align: center
   :width: 35em


можно искать, сверху часто нужные, снизу - все. 

Основные операции с проекциями, которые нужно знать для работы:
---------------------------------------------------------------------




Как узнать систему координат слоя
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Для векторного слоя - свойства общие
Для растрового слоя - свойства общие

Открытие окна преобразования координат
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

В правом-нижнем углу карты нажмите кнопку. Если написано OTF - значит преобразование на лету включёно.

Если картинка на карте сплющена по вертикали.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Если вы добавили геоданные на карту, и картинка сплющенная - то включите "Преобразование коодинат на лету" в EPSG:3857. Это значит что ваши геоданные были в градусах.


Если данные из разных слоёв не попадают друг на друга, хотя они в одном месте.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Включите "Преобразование коодинат на лету".

Пересохранение слоёв в другую систему координат
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Сохранить как - и выбираете СК. 




Добавление геоданных
====================

NextGIS QGIS предоставляет пользователю возможность добавлять

* Векторные данные
* Растровые данные
* Подкладывать подложки из интернета
* Работать по протоколам WMS, WFS, TMS
* Рисовать самому

Добавление растровых и векторных слоёв из файлов
--------------------------------------------------------

Добавление картоподложки из интернета
--------------------------------------------------------

Работа по протоколу WFS
--------------------------------------------------------

Работа с базами данных PostGIS
--------------------------------------------------------


Рисовать самому
========================================================


Настройка стилей
====================

Компоновщик карты
====================

.. `composer_main_properties`:

.. test:
